# Lore Oracle: Cloud AI Assistant (Opt-In)

## Background
Users desire a natural language interface to query their vault ("Who is the king?"). Running local LLMs proves too resource-intensive for mobile/tablet devices. Therefore, we will implement an **Opt-In Cloud Oracle** powered by Google Gemini.

## Objectives
1.  **Accessibility**: Ensure the feature works on any device (phone, tablet, laptop) without heavy hardware requirements.
2.  **RAG (Retrieval-Augmented Generation)**: Use the local `FlexSearch` index to retrieve relevant notes and send them as context to the Gemini API.
3.  **Opt-In Privacy**: The feature must be disabled by default. Users must explicitly provide their own API Key to enable it, understanding that snippets of their data will be sent to Google for inference.

## Constraints
-   **Network**: Requires active internet connection.
-   **Secrets**: API Keys must be stored locally (IndexedDB/LocalStorage) and NEVER transmitted to our own servers or logged.
-   **Cost**: Rely on Google Gemini's free tier (Flash model) via user's own key.

## Implementation Plan

### 1. AI Core (Service)
*   Install `@google/generative-ai`.
*   Create `GeminiService` to handle API communication.
*   Implement `RAG` logic: Search -> Retrieve Content -> Construct Prompt -> Call API.

### 2. Settings & UI
*   `Settings` -> `AI`: Input field for "Gemini API Key".
*   `OracleChat.svelte`: Chat interface. Disabled/Hidden if no key is present.

## User Story
As a DM on an iPad, I want to ask "Summarize the history of the Red Faction" and get an answer generated by Gemini using my local notes, without my tablet crashing from memory exhaustion.